---
title: "Reproducible Science & Figures Assignment"
output:
  html_document: default
  pdf_document: default
date: "2024-12-09"
editor_options: 
  markdown: 
    wrap: 72
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

*The following is a template .rmd RMarkdown file for you to use for your
homework submission.*

*Please Knit your .rmd to a PDF format or HTML and submit that with no
identifiers like your name.*

*To create a PDF, first install tinytex and load the package. Then press
the Knit arrow and select "Knit to PDF".*

## QUESTION 01: Data Visualisation for Science Communication

Loading libraries

```{r}
library(tidyverse)
library(palmerpenguins)
library(janitor)
library(ragg)
library(here)
library(svglite)
```

Loading and saving raw data set

```{r}
penguins_raw 
write_csv(penguins_raw, here("data", "penguins_raw.csv"))
```

Loading functions

```{r}
source(here("functions", "Functions_For_Penguins.R"))
```

Cleaning the raw data and saving as a new data file

```{r}
#clean data
penguins_cleaned <- penguins_raw %>%
  clean_column_names() %>%
  remove_columns("comments") %>%
  remove_columns("delta") %>%
  remove_empty_columns_rows() %>%
  shorten_species() %>%
  shorten_sex ()

#save and load clean data
write_csv(penguins_cleaned, here("data", "penguins_clean.csv"))

penguins_cleaned <- read_csv(here("data", "penguins_clean.csv"), show_col_types = FALSE)

#visualise the cleaned data
colnames(penguins_cleaned)
penguins_cleaned
```

Creating a figure using the Palmer Penguin data set that is correct but
badly communicates the data

```{r bad figure code, echo=FALSE}
# Saving dataset of species, flipper length & body mass columns and removing NA values 
species_flipper_length_and_bodymass <- penguins_cleaned %>% select(species, flipper_length_mm, body_mass_g) %>%
  drop_na()

# Visualising modified data set 
species_flipper_length_and_bodymass

# Saving modified data set to use in scatterplot
write_csv(penguins_cleaned, here("data", "species_flipper_length_and_bodymass.csv"))
```

### a) Figure:

```{r echo=FALSE}
# Creating scatterplot
ggplot(species_flipper_length_and_bodymass, aes(x = flipper_length_mm, y = body_mass_g, color = species)) +
  geom_point(size = 10, alpha = 0.1) +  # Overly large points with excessive transparency
  labs(title = "Flipper Length vs Body Mass", 
       x = "Flipper Length (mm)", 
       y = "Body Mass (g)") +
  theme_minimal() +
  theme(axis.text = element_text(size = 3, angle = 90, color = "black"),
        legend.position = "top") +  
  scale_color_manual(values = c("hotpink", "yellow", "limegreen")) +  
  coord_cartesian(xlim = c(150, 250), ylim = c(1000, 7000))

```

### b) Explanation of poor design choices

This graph plots the body mass against flipper length for three penguin
species. However, the design choices in this graph are misleading and
poorly communicate the data. One reason for this is that the patterns in
the data are are difficult to see due to the overly large points with
excessive transparency that blend with one another, and are hard to see
over clashing colours. For example pink and yellow points overlap so we
cannot fully view the data for these two species. Additionally, the view
of the data is restricted by the axis as these do not start at 0, so any
potential outliers are not seen making the graph misleading. Finally,
the graphical elements of this graph are unclear as the text on the axis
is too small to read easily without zooming in, and the labels on the x
axis are oriented at a 90 degree angle making it awkward to read
(Whitlock and Schluter, 2019).

------------------------------------------------------------------------

## QUESTION 2: Data Pipeline

*Write a data analysis pipeline in your .rmd RMarkdown file. You should
be aiming to write a clear explanation of the steps, the figures
visible, as well as clear code.*

*Your code should include the steps practiced in the lab session:*

-   *Load the data*

-   *Appropriately clean the data*

-   *Create an Exploratory Figure (**not a boxplot**)*

-   *Save the figure*

-   ***New**: Run a statistical test*

-   ***New**: Create a Results Figure*

-   *Save the figure*

*An exploratory figure shows raw data, such as the distribution of the
data. A results figure demonstrates the stats method chosen, and
includes the results of the stats test.*

*Between your code, communicate clearly what you are doing and why.*

*Your text should include:*

#### Introduction

Sexual size dimorphism is a trait exhibited by many vertebrate species
as a result of selective forces acting differently on males and females
due to their differing reproductive and ecological roles. This trend has
been found to be true in penguins, particularly in differing flipper
lengths with males having larger flippers than females (Jennings et al.,
2016). This study will investigate sexual size dimorphism in the Adelie
species of penguin by testing whether males have larger flipper lengths
than females using. a linear model analysis of the 'Palmer Penguins'
data set. If there is no sexual size dimorphism in this species, we
would expect that the null hypothesis that there is no significant
difference in flipper length between males and females to be true . This
would mean that the coefficient of the linear model analysis would not
be statistically different from zero. If the coefficient of the linear
model analysis *is* statistically different from zero, we can reject
this null hypothesis and this would support the alternate hypothesis
that sexual size dimorphism in flippers does occur in Adelie penguins.

#### Stats Method

Loading libraries

```{r}
library(tidyverse)
library(palmerpenguins)
library(janitor)
library(ragg)
library(here)
library(svglite)
```

Loading and saving raw data set

```{r}
penguins_raw 
write_csv(penguins_raw, here("data", "penguins_raw.csv"))
```

Loading functions

```{r}
source(here("functions", "Functions_For_Penguins.R"))
source(here("functions", "Exploratory_Plotting.R"))
```

Cleaning the raw data and saving as a new data file

```{r}
#clean data
penguins_cleaned <- penguins_raw %>%
  clean_column_names() %>%
  remove_columns("comments") %>%
  remove_columns("delta") %>%
  remove_empty_columns_rows() %>%
  shorten_species() %>%
  shorten_sex ()

#save and load clean data
write_csv(penguins_cleaned, here("data", "penguins_clean.csv"))

penguins_cleaned <- read_csv(here("data", "penguins_clean.csv"), show_col_types = FALSE)

#visualise the cleaned data
colnames(penguins_cleaned)
penguins_cleaned
```

```{r}
# Saving dataset of Adelie penguins, flipper length & sex columns and removing NA values 
adelie_flipper_length_and_sex <- penguins_cleaned %>%
  select(species, flipper_length_mm, sex) %>%
  filter(species == "Adelie") %>%
  drop_na()

write_csv(adelie_flipper_length_and_sex, here("data", "adelie_flipper_length_and_sex.csv"))
```

Exploratory plot of raw data
```{r}
# using exploratory plotting function generate violin plot
plot_flipper_violin(adelie_flipper_length_and_sex)

# Saving the plot as a PNG file in figures folder
save_flipper_violin_png(
  penguins_flippers = adelie_flipper_length_and_sex, 
  filename = "Figures/adelie_flipper_violin_plot.png", 
  size = 15,
  res = 300,
  scaling = 1
)

# Saving the plot as an SVG file in figures folder
save_flipper_plot_svg(
  penguins_flippers = adelie_flipper_length_and_sex,
  filename = "Figures/adelie_flipper_violin_plot.svg", 
  size = 15,
  scaling = 1
)

```


-   *Results*

-   *Discussion*

-   *Conclusion*

*You will be marked on the following:*

### a) Your code for readability and functionality

### b) Your figures for communication

### c) Your text communication of your analysis

*Below is a template you can use.*

------------------------------------------------------------------------

### Introduction

```{r Data Exploration}

# Make sure your code prints. 

```

### Hypothesis

### Statistical Methods

```{r Statistics}

# Make sure your code prints. 

```

### Results & Discussion

```{r Plotting Results}

# Make sure your code prints. 

```

### Conclusion

------------------------------------------------------------------------

## QUESTION 3: Open Science

### a) GitHub

*Upload your RProject you created for **Question 2** and any files and
subfolders used to GitHub. Do not include any identifiers such as your
name. Make sure your GitHub repo is public.*

*GitHub link:*

*You will be marked on your repo organisation and readability.*

### b) Share your repo with a partner, download, and try to run their data pipeline.

*Partner's GitHub link:*

*You **must** provide this so I can verify there is no plagiarism
between you and your partner.*

### c) Reflect on your experience running their code. (300-500 words)

-   *What elements of your partner's code helped you to understand their
    data pipeline?*

-   *Did it run? Did you need to fix anything?*

-   *What suggestions would you make for improving their code to make it
    more understandable or reproducible, and why?*

-   *If you needed to alter your partner's figure using their code, do
    you think that would be easy or difficult, and why?*

### d) Reflect on your own code based on your experience with your partner's code and their review of yours. (300-500 words)

-   *What improvements did they suggest, and do you agree?*

-   *What did you learn about writing code for other people?*
